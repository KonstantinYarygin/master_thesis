\chapter{Материалы и методы}
\label{Sec:material}

\section{Экспериментальные данные}
\paragraph{Штаммы \textit{H. pylori}.}
В работе использовались следующие штаммы: 26695, J99 и А45. Данные штаммы были выращены на среде, содержащий колумбийский агар и инактивированную лошадиную сыворотку. 

Также в работе использовались изогенные штаммы А45.  В этих штаммах была произведена вставка гена устойчивости к канамицину в соответствующие гены, относящиеся к системе рестрикции-модификации. 

\paragraph{Секвенирование ридов RNA-seq.}
Из выращенных культур в логарифмической стадии роста была выделена и отсеквенврована тотальная РНК. Секвенирование производилось на приборе SOLID 5500.

\paragraph{Масс-спектрометический анализ.}
В двух временных точках в логарифмической стадии роста из всех штаммов был взят протеом. Анализ белков производился на масс-спектрометре Tripple-TOF с методом ионизации электроспреем ESI.

Эксперименты, секвенировние и масс-спектрометрический анализ производились лабораторией Системной биологии МФТИ и лабораторией протеомного анализа ФГБУ ФНКЦ ФХМ ФМБА России.

\section{Обработка данных}
\subsection{Данные RNA-seq}
\paragraph{Картирование.}
Риды, полученные после секвенирования, были картированы на соответствующие референсные геномы, взяты из базы данных NCBI (http://ncbi.nlm.nih.gov/). Картировние ридов осуществлялось при помощи программы bowtie.
% со следующими параметрами:
%\begin{verbatim} 
%bowtie -v 3 -C <рефересный геном> -a --best --strata -trim3 23 -f <файл с ридами *.scfasta> -Q <файл с качеством ридов *.QV.qual> -S <файл для записи результатов *.sam>
%\end{verbatim} 
Параметры выбраны в соответствии с рекомендациями разработчиков, а также добавлен параметр -trim3 N, обрезающий N нуклеотидов с конца рида. Данный параметр выбран исходя из анализа качества ридов.

\paragraph{Расчет дифференциальной экспрессии генов.}
Для расчета количество ридов на ген,  была использована программа coverageBed (http://bedtools.readthedocs.io/en/latest/content/tools/coverage.html, из программного пакета bedtools
% : 
%\begin{verbatim} 
%coverageBed -abam <файл с картированными ридами *.bam> -b <аннотация генома *.gff> > <выходной файл *.txt>
%\end{verbatim}

В результате получены таблицы, где указано название генов и количество уникально выравнявшихся на них ридов. Для того чтобы сделать расчет дифференциальной экспрессии (ДЭ) генов, необходим сопоставить гены по группам ортологии. Поиск ортологов между штаммами был произведен при помощи программы OrthoFinder  (https://github.com/davidemms/OrthoFinder). Данная программа определяет ортологов по  аминокислотными последовательностям соответствующим генам и объединяет гены в группы, если схожесть аминокислотных последовательностей выше \%.
% Запуск программы:
%\begin{verbatim} 
%python orthofinder.py -f <папка с fasa-фалйами>  -t <количество потоков>
%\end{verbatim}

На выходе программы получаем таблицу с генам, разделенными по группам ортологии. Для расчета ДЭ были выбраны только те группы, которые содержат по 
одному гену из каждого штамма. 

Расчет ДЭ был сделан в R-скрипте с использованием библиотеки DESeq (http://bioconductor.org/packages/release/bioc/html/DESeq.html).  

\paragraph{Поиск транскрипционных старт-сайтов (ТСС).}
Для поиска ТСС по траснкрипционному профилю был применен следующий алгоритм:
\begin{enumerate}[noitemsep,topsep=0pt]
\item По данным покрытия рассчитываем количество ридов, начинающихся на данной позиции в геноме(по обратной и прямой цепи) $ \Rightarrow $ получаем профиль покрытия.
\item По профилю покрытия определяем локальные максимумы $ \Rightarrow $  каталог локальных пиков.
\item Определяем статистически-значимые пики: сравниваем на сколько совпадает транскрипционный профиль вблизи пика с теоретическим профилем для ТСС (f(x) = 1, x > ТСС; f(x) = 0, x < TCC) (Рис.~\ref{fig:pick}) $ \Rightarrow $ каталог статистически значимых пиков (p-value < 0.05).
\begin{figure}[h]
% \center{\includegraphics[scale=0.5]{peaks_HP0014.png}}
\caption{Пример: Пик перед геном HP0014}
\label{fig:pick}
\end{figure}
\item Проводим аннотация отобранных пиков: приписываем пики к генам, исходя из расстояния от них до гена. Классификация ТСС использовалась такая же как и в статье Синтии Шарм []. 
\end{enumerate}
Алгоритм реализован на языке R.

\subsection{Выравнивание последовательностей и консервативность ТСС}

Для выравнивания последовательностей использовалась программа nucmmer. На вход программе подаются последовательности, которые хотим сравнить, - qwery, и, с которыми хотим сравнить - reference. В общем случае qwery представляет собой набор из подпоследовательностей, a reference - собранный геном. В качестве критериев оценки схожести последовательностей рассчитываются следующие показатели:
\begin{description}[noitemsep,topsep=0pt]
\item[MLength/QLength] - \% выравненной области;
\item[NSNP] - количество полиморфизмов;
\item[FSNP] - частота полиморфизмов;
\end{description}

Для расчета консервативности ТСС и 5'UTR в качестве qwery берем набор подпоследовательностей, составленный из участков генома NC\_000915.1, вырезанных по позициям от TSS до конца гена, а reference - полные геномы хеликобактера, имеющиеся в базе NCBI. Дополнительно по результатам выравнивания считаем показатели:
\begin{description}[noitemsep,topsep=0pt]
\item[DSatrt] - расстояние от 1-го совпавшего нуклеотида до старта гена;
\item[Olaps] - отношение ширины 5’UTR в другом штамме к 26695 (\%)
\end{description}

По полученным показателям отбираем ТСС и 5'UTR, которые мы будем считать совпавшими с  ТСС из штамма 26695. Критерии отбора были разделены на первичные и вторичные. Первичные используются для фильтрации неверно выравненных последовательностей, вторичные оценивают показатели совпадения 5’UTR:

\begin{itemize}[noitemsep,topsep=0pt]
\item DStart >  0 \& DSatrt < 500  - первичные 
\item 0.8 < Mlength/QLength < 1.1 - первичные
\item 0.9 < Olaps < 1.1- вторичные
\item QStart == 1  - вторичные
\end{itemize}

Итоговая величина консервативности ТСС равняется отношению количества штаммов с совпавшими ТСС к количеству штаммов с гомологичным  геном, к которому приписан ТСС:

\textbf{Консервативность TSS} = (количество штаммов с совпавшими ТСС / количество штаммов с гомологичным геном)

\subsection{Поиск промоторных последоватльностей.} Промоторные последовательности можно представить в виде матриц, содержащих информацию о вероятность нахождения данного нуклеотида в данной позиции. Такие матрицы были составлены при помощи программы MEME. Далее в регуляторных последовательностях производился поиск по матрицам при помощи программы RSAT. 

\subsection{Данные масс-спектрометрического анализа}
Для пептидных идентификация использовалась программы Mascot v2.2.07. При идентификации программой Mascot были выставлены следующие параметры: точность 20 мд для родительский ионов, 0.5 Да для дочерних ионов, модификации — окисление и карбомидометил. Квантификация пептидов производилась при помощи программы Progenesis [], которая на одном из этапов анализа использует результаты идентификации Mascot.  В ходе работы программы Progenesis отбирались пептиды с рангом меньше 15 и зарядом не более 4. Также квантификация производилась независимо по результатам работы программы Mascot отдельно по каждому набору спектров для образцов.
\subsection{Статистический анализ и визуализация}
Для статистического анализа использовался язык программирования R [], в качестве среды разработки использовался RStudio []. Для визуализации данных использовались библиотеки R (qplots, ggplot2) и Cytoscape [] для отображения сетей взаимодействий.