\section{Материалы и методы}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsection{Общая схема анализа}
В данной работе исследовались отношения ``бактерия-болезнь'' и ``бактерия-нутриент'' в научных публикациях по теме ``микробиота кишечника человека''. Тексты статей делились на предложения, каждое из которых анализировалось на предмет содержания в нем названий сущностей из следующих трех групп:
\begin{enumerate}[noitemsep,topsep=0pt]
\item Бактерии
\item Болезни
\item Нутриенты
\end{enumerate}

Если предложение их не содержало, либо содержало только названия из одной группы сущностей, оно отбрасывалось и не подвергалось последующему анализу. Отобранные таким образом предложения проходили синтаксический разбор и пред-обработку: каждое предложение разбивалось на отдельные слова, для слов определялись их части речи, по предложению строился граф зависимостей, в котором находились кратчайшие пути для каждой пары сущностей из разных групп. Используя полученную информацию о предложении оно классифицировалось как не содержащее какого-либо отношения для всех пар сущностей, либо как содержащие (в таком случае также определялся тип этого отношения). Схема анализа представлена на рисунке~\ref{pipeline}.
\begin{figure}[h]
    \begin{center}
        \includegraphics[width=1.\linewidth]{pipeline.png}
    \end{center}
\caption{Схема нахождения зависимостей между бактериями, нутриентами и болезнями в медикобиологичеких текстах.}\label{pipeline}
\end{figure}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsection{Информационный поиск}
Поисковая система Pubmed Central индексирует (по состоянию на 17.12.2015) около 20000 статей по запросу ``human gut microbiota''. Из них в открытом доступе находятся 9219 статей. Для анализа использовалось три группы документов:
\begin{enumerate}[noitemsep,topsep=0pt]
\item Статьи, которые имеются в открытом доступе в хранилище PubMed Central. Статьи были выкачаны в формате nxml с серверов NBCI через ftp. Количество документов: 9219
\item Статьи, к которым не было отрытого доступа, но копии которых нашлись в онлайн-библиотеке LibGen. Количество документов: 6909
\item Аннотации тех статей, для которых не нашлось полных текстов ни в PubMed Central, ни в LibGen. Количество документов: 6708
\end{enumerate}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsection{Распознавание именованных сущностей}

Для поиска именованных сущностей нами было решено использовать поиск, основанный на словаре, как самый распространенный и легко реализуемый. Для каждой из трех групп интересующих нас сущностей (бактерии, болезни и нутриенты) была выбрана собственная онтология или база данных и по ней был составлен словарь терминов.

\begin{itemize}[noitemsep,topsep=0pt]
\item \textbf{Бактерии.} В качестве основы для составления словаря была выбрана база данных NCBI Taxonomy (\url{http://www.ncbi.nlm.nih.gov/taxonomy}), как наиболее полная и хорошо курируемая. Также NCBI Taxonomy содержит не только номенклатурные названия бактерий на всех таксономических уровнях, но их тривиальные, а так же устаревшие названия. Для составления словаря были взяты только бактерии, населяющие кишечник человека. Список видов кишечных бактерий был взят из работы Д. Ритари~\cite{Ritari_2015}. Для каждого вида в словарь были включены его название, названия всех соответствующих ему более высоких таксономических уровней (вплоть до типа), а также их синонимы, устаревшие названия и сокращенные формы в единственном и множественных числах.
\item \textbf{Болезни.} В качестве основы для составления словаря была выбрана база данных Disease ontology~\cite{Schriml_2012} (\url{http://disease-ontology.org/}). Данная онтология содержит названия болезней человека, характеристик фенотипа, связанные с ними медицинский с ними списки медицинских терминов, а также связи между всем вышеперечисленным. Для каждой болезни Disease ontology содержит список синонимов, под которыми она может упоминаться. Для составления словаря были взяты названия болезней, их синонимы, а также всевозможные формы написания в разных регистрах.
\item \textbf{Нутриенты.} В качестве основы для словаря был взят вручную составленный список веществ, содержащихся в пище. В словарь вошли все вещества из подготовленного списка, их синонимы, номенклатурные и тривиальные названия, а также всевозможные формы написания в разных регистрах.
\end{itemize}

Для каждого предложения был произведен поиск наличия в нем всех сущностей из всех трех групп. Для каждой найденной сущности сохранялось название, под которым она фигурировала в предложении и ее уникальный идентификатор. Предложение выбрасывалось и не проходило дальнейший анализ, если в нем либо встречались сущности только из одной группы, либо не встречались вовсе.

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsection{Извлечение отношений}

Перед извлечением отношений между различными сущностями каждое предложение подвергалось пред-обработке и синтаксическому разбору. В частности, для каждого предложения строился соответствующей ему граф зависимостей и для каждого слова в предложении определялась его часть речи. Из графа зависимостей удалялась информация о направлении связей, граф таким образом становился неориентированным. Если сущность, упоминаемая в предложении, состояла из двух слов или больше, то соответствующие им вершины в графе зависимостей сливались в одну. Также из графа удалялись следующие ребра:
\begin{enumerate}[noitemsep,topsep=0pt]
\item Ребра, отражающие связь между придаточной и главной частями в сложноподчиненном предложении
\item Ребра, отражающие сочинение между двумя простыми предложениями в составе сложносочиненного
\item Ребра, отражающие союзную связь между однородными членами предложения, в том случае, если эти члены являются глаголами
\end{enumerate}
В предобработанном таким способом графе для каждой пары сущностей из различных групп находится кратчайший путь между ними. Далее полученная информация (обработанный граф, части речи и кратчайшие пути) использовались для нахождения отношений.
Для извлечения отношений между различными сущностями было решено использовать подход, основанный на правилах (паттернах). Данное решение было обусловлено тем, что в настоящее время не существует корпусов с размеченными отношениями между бактериями, нутриентами и болезнями, что исключает применение методов, основанных на машинном обучении. Для определения паттернов было вручную отобрано около двухсот предложений, содержащих отношения между а) бактериями и болезнями, б) бактериями и нутриентами. На основе анализа структуры и свойств предложения и его характеристик (части речи, граф зависимостей и кратчайшие пути) были выбраны несколько характерных паттернов для определения наличия какого-либо отношения в предложении и типа этого отношения. Паттерн представляет собой набор правил, описывающих структуру графа и кратчайшего пути между сущностями.


\subsubsection{Паттерны для извлечения отношений ``бактерия-болезнь''}

Все отношения, которыми могут быть связаны бактерия и болезнь были поделены на четыре группы:
\begin{enumerate}[noitemsep,topsep=0pt]
\item Бактерия вызывает болезнь или усугубляет ее течение
\item Бактерия оказывает протективное действие при болезни
\item Болезнь ассоциирована с повышенной представленностью бактерии
\item Болезнь ассоциирована с пониженной представленностью бактерии
\end{enumerate}

\begin{itemize}
\item \textbf{Паттерн №1}
\end{itemize}

\texttt{$[B] \rightarrow ... \rightarrow [ABUND\_WORD] \rightarrow ... \rightarrow [D]$ \\}
\-\hspace{4cm}\texttt{$\searrow[POS\_QUAL|NEG\_QUAL]$}

Кратчайший путь между сущностями в графе зависимостей должен содержать слово-триггер, служащее для описания представленности (\emph{ABUND\_WORD} на схеме). Этим словом может являться любое слово, однокоренное с одним из следующих: \emph{presence, abundance, prevalence, amount, occurrence, richness, proportion, incidence, quantity, fraction, portion, percentage, carriage, number}. Вершина, соответствующая этому слову должна быть связана с вершиной, соответствующей слову, описывающему изменение представленности в большую или меньшую сторону (\emph{POS\_QUAL} и \emph{NEG\_QUAL} на схеме соответственно). Словом, описывающим положительное изменение, может быть любое слово, однокоренное с одним из следующих: \emph{increase, great, enhance, elevated, high, larg}; описывающим отрицательное изменение, соответственно: \emph{reduce, low, diminish, decrease, less, small}. Паттерн служит для описания отношений из 3 и 4 группы.

Пример:

\emph{Finally, a \textbf{diminished prevalence} and abundance of \textbf{F. prausnitzii} are revealed in the fecal samples of patients with \textbf{IBD}.}


\begin{itemize}
\item \textbf{Паттерн №2}
\end{itemize}

\texttt{$[B] \rightarrow (0-2 nodes) \rightarrow [INCREASE|DECREASE] \rightarrow ... \rightarrow [D]$ }

Кратчайший путь между сущностями должен содержать слово-триггер --- слово, однокоренное со словом \emph{increase} либо \emph{decrease}. Расстояние в графе между вершиной, соответствующей слову-триггеру и вершиной, соответствующей названию бактерии, должно быть меньше либо равным трем. Паттерн служит для описания отношений из 3 и 4 группы.

Пример:

\emph{\textbf{Faecalibacterium prausnitzii} is also consistently \textbf{decreased} in human \textbf{IBD} patients and considered an important bacterial group for maintaining microbial homeostasis.}

\begin{itemize}
\item \textbf{Паттерн №3}
\end{itemize}

\texttt{$[B] \rightarrow ... \rightarrow [CAUSE\_WORD|PREVENT\_WORD] \rightarrow (0-1 nodes) \rightarrow [D]$}

Кратчайший путь между сущностями должен содержать слово-триггер, описывающее эффект, оказываемый на болезнь (\emph{CAUSE\_WORD} и \emph{PREVENT\_WORD} на схеме). Эффект может быть положительным (протективное действие), в этом случае слово-триггер (\emph{PREVENT\_WORD}) --- слово, однокоренное с одним из следующих: \emph{Prevent, attenuate, inhibit, ameliorate, alleviate, counteract, mitigate, protect, suppress, treat.} В случае отрицательного эффекта слово-триггер (\emph{CAUSE\_WORD}) должно быть однокоренным с одним из следующих: \emph{Pcause, provoke, exacerbate, induce, initiate, promote, stimulate, dampen}. Расстояние в графе между вершиной слова-триггера и вершиной название болезни должно быть меньше либо равно двум. Данный паттерн служит для описания отношений из групп 1 и 2.

Пример:

\emph{PThe assessment of gastritis based on histopathological criteria was completely changed after recognition of \textbf{H. pylori} as the most common \textbf{cause} of \textbf{chronic gastritis}.}

\begin{itemize}
\item \textbf{Паттерн №4}
\end{itemize}

\texttt{$[B] \rightarrow ... \rightarrow [CORELL] \rightarrow ... \rightarrow [D]$\\}
\-\hspace{4cm}\texttt{$\searrow?[NEG|INVERS]$}

Кратчайший путь между сущностями должен содержать слово, однокоренное со словом \emph{correlation}. Также оно может быть связано с вершиной, соответствующей слову, однокоренному со словом \emph{inversely} или \emph{negatively}, что будет сигнализировать об отрицательной зависимости. Паттерн служит для поиска отношений группы 3 или 4. В том случае, если выполняется второе условие (связь с \emph{inversely} или \emph{negatively}), то отношение относится к четвертой категории, иначе --- к третьей.

Пример:

\emph{We found that the \textbf{colitis} scores \textbf{correlated} with the abundance of \textbf{Burkholderia} (p=0.0045) and the richness of \textbf{Lactobacillus} group (p=0.006).}

\begin{itemize}
\item \textbf{Паттерн №5}
\end{itemize}

\texttt{$[B] \rightarrow [D]$\\}
\-\hspace{2.5cm}\texttt{$\searrow[CAUSE\_WORD|PREVENT\_WORD]$}

Длина кратчайший пути должна быть 1 (бактерия и болезнь связаны в графе непосредственно). Также вершина, соответствующая названию болезни, должна быть связана с вершиной, соответствующей слову-триггеру (\emph{CAUSE\_WORD} и \emph{PREVENT\_WORD} на схеме). Слова-триггеры те же, что и используются в паттерне №3. Данный паттерн служит для описания отношений из групп 1 и 2.

Пример:

\emph{Telomere shortening is closely associated with severity of \textbf{H. pylori induced gastritis} and CDH1 methylation status.}

% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

\subsubsection{Паттерны для извлечения отношений ``бактерия-нутриент''}

Все отношения, которыми могут быть связаны бактерия и нутриент, были также разделены нами на четыре группы. Для каждой группы был составлен список слов-триггеров, которые могут описывать данное взаимодействие (см Табл.~\ref{pattern_table}).

\begin{table}[ht]
\caption{Группы  взаимодействий и слова-триггеры для каждой из них.}\label{pattern_table}
\centering
\hspace{-2cm}
\begin{tabular}{|P{2cm}|P{3cm}|P{4.7cm}|P{4cm}|P{2cm}|}
\hline

\textbf{Номер группы} & Группа 1 & Группа 2 & Группа 3 & Группа 4 \\ \hline

\textbf{Тип взаимодействия} &
Бактерия может поглощать нутриент &
Бактерия использует в своем метаболизме использует нутриент как субстрат &
Бактерия производит нутриент в результате своего метаболизма &
Бактерия секретирует вещество  \\ \hline


\textbf{Слова\-триггеры, описывающие взаимодействие} &
\emph{consume, acquire, absorb, ingest, retain, adhere, adopt, assimilate, obtain, eat} &
\emph{degrade, utilize, utilise, metabolize, metabolise, ferment, hydrolyze, cleave, catabolize, digest, bind, hydrolyse, lyse, convert, destroy, eliminate, dephosphorylate, exploit, transform, eradicate, dissociate, deactivate, neutralize, dimerize, inactivate, phosphorylate, heterodimerizes, decarboxylate} &
\emph{produce, generate, synthesize, synthesise, biosynthesize, biosynthesise, assemble, create, make} &
\emph{secrete, excrete, liberate} \\ \hline

\end{tabular}
\end{table}

Здесь, в отличии от паттернов для нахождения отношений между бактериями и болезнями, любой из паттернов может подойти для описания любой из групп взаимодействий. Тип найденного отношения определяется исключительно группой слова-триггера, найденного в кратчайшем пути.


\begin{itemize}
\item \textbf{Паттерн №1}
\end{itemize}

\texttt{$[B] \rightarrow ... \rightarrow [VERB\_TRIGGER] \rightarrow (0-1 nodes) \rightarrow [N]$\\}
\-\hspace{7.2cm}\texttt{$obj$}

Кратчайший путь между сущностями в графе зависимостей должен содержать вершину, соответствующую слову, однокоренному с одним из слов триггеров, причем это слово должно являться глаголом (\emph{VERB\_TRIGGER} на схеме). Расстояние между этой вершиной и вершиной-нутриентом должно быть равно 1 или 2. Связь, ведущая от слова-триггера к названию нутриента, должна отражать прямое или косвенное дополнение (\emph{англ.}: object)

Пример:

\emph{The \textbf{Lactobacillus} strains were investigated for their capability to \textbf{assimilate} \textbf{cholesterol} under simulated intestinal conditions.}

\begin{itemize}
\item \textbf{Паттерн №2}
\end{itemize}

\texttt{$[B] \rightarrow [VBN\_TRIGGER] \rightarrow ... \rightarrow [N]$\\}
\-\hspace{3.5cm}\texttt{$\searrow[by]$}

Кратчайший путь должен между сущностями должен содержать вершину, соответствующую слову, однокоренному с одним из слов триггеров, и это слово должно быть причастием прошедшего времени (\emph{VBN\_TRIGGER} на схеме). Вершина-триггер должна быть связана с вершиной, соответствующей слову \emph{by}, а также расстояние между ней и вершиной-названием бактерии должно быть равным 1.

Пример:

\emph{\textbf{Butyric acid} is one of the metabolites \textbf{produced by F. prausnitzii}, which is an important energy source for the intestinal epithelial cells and has an inverse correlation with disease activity.}


\begin{itemize}
\item \textbf{Паттерн №3}
\end{itemize}

\texttt{$[B] \rightarrow [*] \rightarrow [VBN\_TRIGGER] \rightarrow ... \rightarrow [N]$\\}
\-\hspace{2.5cm}\texttt{$\searrow[by]$}

Этот паттерн аналогичен паттерну №2, с той лишь разницей, что между вершиной триггерного слова и вершиной названия бактерии может находиться еще одна вершина (любая), с которой и должно быть связано слово \emph{by}.

Пример:

\emph{The amount of \textbf{cholesterol assimilated by} the probiotic \textbf{Lactobacillus} strains in terms of a dose of 10 cells was calculated.}

\begin{itemize}
\item \textbf{Паттерн №4}
\end{itemize}

\texttt{$[B] \rightarrow ... \rightarrow [NOUN\_TRIGGER] \rightarrow [N]$}

Кратчайший путь должен между сущностями должен содержать вершину, соответствующую слову, однокоренному с одним из слов триггеров, и это слово должно быть существительным (\emph{NOUN\_TRIGGER} на схеме). Вершина-триггер должна напрямую быть связана с вершиной, соответствующей названию нутриента.

Пример:

\emph{The main \textbf{producers} of \textbf{folate} are \textbf{Bifidobacterium bifidum} and \textbf{B. longum} subsp.}


После того, как предложение подошло под один из паттернов, в графе зависимостей производится поиск связанных с вершиной, соответствующей слову-триггеру, ребер с тэгом \emph{neg} (от \emph{англ.} negation, отрицание). Если такие ребра есть, то предложение отбрасывается, как содержащее отрицание. Пример такого предложения:

\emph{Unlike other enteropathogenic bacteria, \textbf{C. jejuni cannot utilize glucose} as a growth substrate since it lacks the glycolytic enzyme phosphofructokinase of the Embden-Meyerhof-Parnas (EMP) pathway.}

Дополнительно, предложение проходит пост-обработку в том случае, если слово-триггер принадлежит второй или третьей группе (вещество участвует в метаболизме бактерии в качестве субстрата или продукта соответственно). Тогда в графе зависимостей ищутся смежные с вершиной-нутриентом узлы, соответствующие предлогам \emph{to}, \emph{into} и \emph{from}, которые могут изменить смысл отношения. Например, для предложения

\emph{Another species of great value for industry is \textbf{C. thermocellum strain}, which is an anaerobic thermophile capable of \textbf{converting} waste cellulose \textbf{into ethanol}.}

парой батерия-нутриент является (\emph{C. thermocellum}; \emph{ethanol}). Предложение подходит под паттерн №1 со словом-триггером \emph{convert} и поэтому отношение сперва отнесено к группе 2 (использование в качестве субстрата). Однако нахождение предлога \emph{into} позволяет отнести отношение к группе 3 (продукт метаболизма).

\subsection{Используемые программные пакеты}

Весь вычислительный конвейер для проведения анализа был написан на языке python3.4 и доступен в открытом доступе: \url{https://github.com/KonstantinYarygin/relation_extraction/tree/kost}. Для лингвистического анализа использовался моду nltk~\cite{Bird_2009}. Синтаксический разбор предложений был сделан с помощью Stanford dependency parser~\cite{Chen_2014}.

\newpage
